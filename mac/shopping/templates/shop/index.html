  {% extends 'shop/basic.html' %}
{% block title %} Home {% endblock %}

{% block css %} 


.col-md-3{
  display:inline-block;
  margin-left:-4px;
}
.card-text,.card{
  font-size:1rem;
  text-align:center;
}
.no-padding{
  padding-left:0;
  padding-right:0;
}
.carousel-indicators li{
  background-color:blue;
  margin-bottom:-25px;
}
.carousel-control-prev,
.carousel-control-next{
  margin-top:-230px;
  top:auto;
  bottom:auto;
}
.card-text p{
  margin-top: 0px;
  margin-bottom: 5px;
}


.product img {
  background-repeat: no-repeat;
  background-size: cover;
  width: 100%;
  height: 250px;
}
.brand .row img {
  border-radius: 20%
}
hr.cat {
  width: 50px;
  height: 2px;
  background-color: coral;
}

#banner {
  background-image: url("../static/shop/images/Banner.jpg");
  width: 100%;
  height: 60vh;
  background-size: cover;
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-position: top 70px center;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

#banner .shop {
  margin-top: 120px !important;
}
{% endblock %}
{% block body %}

{% load static %}
<div class='contain'>
    <div id="demo" class="carousel slide mt-5" data-ride="carousel">

        <ol class="carousel-indicators">
            <li data-target="#demo" data-slide-to="0" class="active"></li>
        
            <li data-target="#demo" data-slide-to="1"></li>
        </ol>
        <div class="carousel-inner container-fluid">
          {% for row in SlideData %}
            <div class="carousel-item {% if forloop.first %} active {% endif %} slide1">
                <h2 class='heading'>
                    {{row.shoe_name_first}} <br>{{row.shoe_name_second}}<br>
                    <span>{{row.shoe_name_third}}</span>
                </h2>
                <div class="p_img">
                  <img src="/media/{{row.slide_image}}" alt=""  width='100%' height='100%'>
                </div>
                <div class="p_details">
                    <h3>
                        {{row.shoe_company_name}}
                        <i class="fa fa-star rate"></i>
                        <i class="fa fa-star rate"></i>
                        <i class="fa fa-star rate"></i>
                        <i class="fa fa-star rate"></i>
                        <i class="fa fa-star "></i>
                    </h3>
                    <h4 class='h4_heading'>{{ row.shoe_name }}</h4>
                    <p>{{row.details}}</p>
                    
                    <span>{{row.price}} &#x20b9;</span>
                </div>
            </div>
            {% endfor %}
            <!-- ---------------------------------------------------------------------------------------- -->
             
        </div>
            
        <a class=" prev" href="#demo" data-slide="prev">
            <span >&#10094;</span>
        </a>
        <a class="next" href="#demo" data-slide="next">
            <span >&#10095;</span>
        </a>
    </div>
</div>


<section class="brand container">
  <div class="row m-0 py-5 ">
      <img src="{% static 'shop/images/1.PNG' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
      <img src="{% static 'shop/images/2.png' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
      <img src="{% static 'shop/images/3.PNG' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
      <img src="{% static 'shop/images/4.PNG' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
      <img src="{% static 'shop/images/5.PNG' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
      <img src="{% static 'shop/images/6.PNG' %}" class="img-fluid col-lg-2 col-md-4 col-sm-6 ">
  </div>
</section>
<section id="banner" class="my-5 py-5">
  <div class="container shop">
    <h4 class="text-uppercase ">Mid Season's Sale</h4>
    <h1>Autumn Collection <br> UP TO 20% OFF</h1>
    <button class="btn btn-primary">Shop Now</button>
  </div>
</section>
<!-- Product Slides --> 
<div class="container-fluid">
  {% for product ,range, nslides in allprods %}
  <hr>
  <div class="container text-center mt-0 py-1">
    <h3>{{product.0.Catagory}}</h3>
    <hr class="mx-auto cat" >
    <p>Here you Can check out our {{product.0.Catagory}} with fair price</p>

  </div>
  {% comment %} <h2 class="mx-5">{{product.0.Catagory}}</h2> {% endcomment %}
  <div id="demo{{forloop.counter}}" class="carousel slide mt-5" data-ride="carousel">
    

    <div class="carousel-inner container no-padding ">

      <div class="carousel-item active">
        {% comment %} <div class="col-xs-3 col-sm-3 col-md-3">
          <div class="card" style="width: 18rem;">
            <img src="/media/{{product.0.Product_img}}" class="card-img-top" alt="...">
            <div class="card-body">
              <h5 class="card-title">{{product.0.Product_Name}}</h5>
              <p class="card-text">{{product.0.Description}}</p>
              <button id="pr{{product.0.id}}" class="btn btn-primary cart">Add To Cart</button>
              <a href="/shop/product/{{product.0.id}}" ><button id="qu{{product.0.id}}" class="btn btn-primary">View</button></a>
            </div>
          </div>
        </div> {% endcomment %}

      {% comment %} {% for i in product|slice:"1:"%} {% endcomment %}
      {% for i in product %}
        <div class="col-xs-3 col-sm-3 col-md-3">
          <div class="card product" style="width: 17rem;">
            <img src="/media/{{i.Product_img}}" class="card-img-top img-fluid" alt="..." id="imgpr{{i.Product_img}}">
            <div class="card-body text-center">
              <h5 class="card-title" id="namepr{{i.id}}">{{i.Product_Name|slice:"0:20"}}</h5>
              <h6 class="card-price mb-2" >Price:- <span id="pricepr{{i.id}}">{{i.Price}}</span>&#x20b9;</h6>
              <p class="card-text">{{i.Description|slice:"0:25"}}...</p>
              <span id="divpr{{i.id}}" class='divpr'>
              <button id="pr{{i.id}}" class="btn btn-primary cart">Add To Cart</button>
              </span>
              <a href="/shop/product/{{i.id}}" ><button id="qu{{i.id}}" class="btn btn-primary">View</button></a>
         </div>
          </div>
        </div>
        {% if forloop.counter|divisibleby:4 and forloop.counter > 0 and not forloop.last %}  
      </div>
      <div class="carousel-item">
        {% endif %}
      {% endfor %}      
    </div>
  </div> 
  </div>
    <a class="carousel-control-prev" href="#demo{{forloop.counter}}" data-slide="prev">
      <span class="carousel-control-prev-icon bg-dark"></span>
    </a>
    <a class="carousel-control-next" href="#demo{{forloop.counter}}" data-slide="next">
      <span class="carousel-control-next-icon bg-dark"></span>
    </a>
    {% endfor %}
</div>

{% endblock %}

{% block js %} 
<script>
// create Cart
if(localStorage.getItem('cart')==null){
  var cart={};
  }
else{
  cart=JSON.parse(localStorage.getItem('cart'));  
  updatecart(cart);
}


//$('.cart').click(function(){
$('.divpr').on('click','button.cart',function(){
  var idstr=this.id.toString();
  if (cart[idstr] != undefined){
    qty=cart[idstr][0]+1;
  }
  else{
    qty=1;
    name=document.getElementById('name'+ idstr).innerHTML;
    price=document.getElementById('price'+ idstr).innerHTML;
    console.log(price)
    cart[idstr] = [qty , name ,price];
  }
  updatecart(cart); 
});

// Create updateCart function
function updatecart(cart){
  var sum=0;
  for ( var item in cart){
    sum=sum+cart[item][0];
    document.getElementById("div" + item).innerHTML = "<button id='minus" + item + "'class='btn btn-primary minus'>-</button> <span id='val"+ item +"''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'>+</button>";
  };
  localStorage.setItem('cart',JSON.stringify(cart));
  //document.getElementById('cart').innerHTML= Object.keys(cart).length;
  document.getElementById('cart').innerHTML= sum;
  console.log(cart)
  updatePopoverCart(cart);
  
};

// Create updatePopoverCart function
updatePopoverCart(cart);
function updatePopoverCart(cart){
  var popStr="";
  popStr=popStr+ "<h6>Cart for your items in my shopping cart </h6><div class='mx-1 my-2'>"
  var i=1;
  for (var item in cart){
    popStr=popStr+ "<b>" + i +". </b>";
    popStr=popStr +document.getElementById('name' + item).innerHTML.slice(0,22) + "...<b><span class='mx-1'> QTY:-</span></b>" +cart[item][0] +"<br>"
    i=i+1;
  }
  popStr=popStr+"</div> <a href='shop/checkout'><button class='btn btn-primary' id='checkout'>Checkout</button></a><button class='btn btn-primary mx-2' onclick='clearcart()' id='clearcart'>Clearcart</button>"
  document.getElementById('popcart').setAttribute('data-content',popStr); 
  $('#popcart').popover('show');

}

// Create ClearCart function
function clearcart(cart){
  cart=JSON.parse(localStorage.getItem('cart'));
  for (var item in cart){
    document.getElementById('div'+item).innerHTML='<button id="'+ item +'" class="btn btn-primary cart">Add To Cart</button>'

  }
  localStorage.clear();
  cart={};
  updatecart(cart);
}

// Create PlusButton function
$('.divpr').on('click', 'button.plus', function() {
  a=this.id.slice(6, );
  cart['pr'+a][0] = cart['pr'+a][0] + 1;
  document.getElementById('valpr'+a).innerHTML = cart['pr'+a][0];
  updatecart(cart);
});


// Create MinusButton function
$('.divpr').on('click', 'button.minus', function() {
  a=this.id.slice(7, );
  cart['pr'+a][0] = cart['pr'+a][0] -1;
  cart['pr'+a][0]= Math.max(0,cart['pr'+a][0]);
  document.getElementById('valpr'+a).innerHTML = cart['pr'+a][0];
  updatecart(cart);
});
</script>
  {% endblock %}
